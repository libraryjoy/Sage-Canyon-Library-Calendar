<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Library Calendar</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #000000;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .header-left {
            flex: 1;
        }
        .header-center {
            flex: 2;
            text-align: center;
        }
        .header-right {
            flex: 1;
        }
        .title-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }
        .header-logo {
            height: 60px;
            width: auto;
            max-width: 80px;
        }
        .title-text {
            text-align: center;
        }
        .dropdown {
            position: relative;
            display: inline-block;
        }
        .dropdown-btn {
            background-color: #B3A369;
            color: #000000;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .dropdown-btn:hover {
            background-color: #9a8a5a;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 400px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1001;
            border-radius: 8px;
            padding: 15px;
            color: #000000;
            text-align: left;
            max-height: 500px;
            overflow-y: auto;
        }
        .dropdown:hover .dropdown-content {
            display: block;
        }
        .dropdown-section {
            margin-bottom: 15px;
        }
        .dropdown-section h4 {
            margin: 0 0 8px 0;
            color: #000000;
            font-size: 14px;
        }
        .dropdown-section ol, .dropdown-section ul {
            margin: 0;
            padding-left: 20px;
        }
        .dropdown-section li {
            margin-bottom: 4px;
            font-size: 12px;
            line-height: 1.4;
        }
        .week-navigation {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 15px;
        }
        .nav-button {
            background-color: #B3A369;
            color: #000000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .nav-button:hover {
            background-color: #9a8a5a;
        }
        .current-week {
            font-size: 16px;
            font-weight: bold;
            color: white;
        }
        .calendar-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .calendar-table th, .calendar-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            vertical-align: top;
        }
        .calendar-table th {
            background-color: #000000;
            color: white;
            font-weight: bold;
        }
        .day-header {
            background-color: #f8f9fa;
            font-weight: bold;
            padding: 10px;
        }
        .day-info {
            background-color: #B3A369;
            padding: 5px;
            margin-bottom: 5px;
            border-radius: 4px;
            font-size: 12px;
            color: #000000;
            font-weight: bold;
        }
        .day-notes {
            background-color: #A3B2A4;
            padding: 3px 5px;
            margin-top: 2px;
            border-radius: 4px;
            font-size: 10px;
            color: #000000;
            font-weight: bold;
            display: block;
        }
        .booking-slot.closed {
            background-color: #6c757d !important;
            color: #ffffff !important;
            cursor: not-allowed !important;
            opacity: 0.6;
        }
        .booking-slot.closed:hover {
            background-color: #6c757d !important;
        }
        .lunch-period {
            background-color: #B3A369;
            color: #000000;
            padding: 8px;
            margin: 2px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            text-align: center;
        }
        .den-time {
            background-color: #A3B2A4;
            color: #000000;
            padding: 8px;
            margin: 2px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            text-align: center;
        }
        .booking-slot.den-time {
            background-color: #A3B2A4;
            color: #000000;
            border: none;
            padding: 8px;
            margin: 2px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
            width: 100%;
            transition: background-color 0.3s;
        }
        .booking-slot.den-time:hover {
            background-color: #8a9a8b;
        }
        .after-school {
            background-color: #B3A369;
            color: #000000;
            padding: 8px;
            margin: 2px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
            text-align: center;
        }
        .booking-slot {
            background-color: #A3B2A4;
            color: #000000;
            border: none;
            padding: 8px;
            margin: 2px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
            width: 100%;
            transition: background-color 0.3s;
        }
        .booking-slot:hover {
            background-color: #8a9a8b;
        }
        .booking-slot.second-half {
            background-color: #B3A369;
        }
        .booking-slot.second-half:hover {
            background-color: #9a8a5a;
        }
        .booking-slot.entire {
            background-color: #000000;
            color: #FFFFFF;
        }
        .booking-slot.entire:hover {
            background-color: #333333;
            color: #FFFFFF;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 500px;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close:hover {
            color: black;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .form-group textarea {
            height: 80px;
            resize: vertical;
        }
        .btn {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .btn-secondary {
            background-color: #6c757d;
        }
        .btn-secondary:hover {
            background-color: #545b62;
        }
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        .btn-danger:hover {
            background-color: #c82333;
        }
        .test-button {
            background-color: #dc3545;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            margin: 20px 0;
            display: block;
            width: 100%;
        }
        .test-button:hover {
            background-color: #c82333;
        }
        .test-output {
            background-color: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            text-align: center;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <div class="dropdown">
                <button class="dropdown-btn">How to use the library scheduler ▼</button>
                <div class="dropdown-content">
                    <div class="dropdown-section">
                        <h4>📅 Booking Time Slots</h4>
                        <ol>
                            <li>Click on any available time slot</li>
                            <li>Enter your name and class/subject</li>
                            <li>Add any special notes if needed, such as if you need me to teach something to your class</li>
                            <li>Click "Save" to confirm your booking</li>
                            <li>If you no longer need the library, please remove your booking so that someone else can schedule it</li>
                        </ol>
                    </div>
                    <div class="dropdown-section">
                        <h4>📝 Managing Bookings</h4>
                        <ul>
                            <li>Click on any booked (dark gray) slot to edit or delete</li>
                            <li>Use the week navigation arrows to view different weeks</li>
                            <li>Choose from "First Half," "Second Half," or "Entire Period"</li>
                        </ul>
                    </div>
                    <div class="dropdown-section">
                        <h4>🍽️ Lunch Periods</h4>
                        <ul>
                            <li>Regular days: 1st & 2nd lunch periods available during A3/B7</li>
                            <li>Wednesday: Lunch period at end of day (1:15-1:45 PM)</li>
                            <li>After school slots available Monday, Tuesday, Thursday, Friday</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="header-center">
            <div class="title-container">
                <img src="SageCanyonMS_CircleMark.png" alt="Sage Canyon Logo" class="header-logo">
                <div class="title-text">
                    <h1>Sage Canyon Library Scheduler</h1>
                    <p>Click on time slots to book the library</p>
                </div>
                <img src="SageCanyonMS_CircleMark.png" alt="Sage Canyon Logo" class="header-logo">
            </div>
        </div>
        <div class="header-right">
            <div class="week-navigation">
                <button class="nav-button" onclick="previousWeek()">← Previous Week</button>
                <span class="current-week" id="current-week">Week of August 18-22, 2025</span>
                <button class="nav-button" onclick="nextWeek()">Next Week →</button>
            </div>
            <div style="margin-top: 5px; font-size: 10px; color: #B3A369;">
                <span id="storage-status">Checking storage...</span>
            </div>
        </div>
    </div>

    <div class="calendar-container">
        
        <table class="calendar-table">
            <thead>
                <tr>
                    <th>Time</th>
                    <th>Monday<br>08/18<br><span class="day-info">A Day</span></th>
                    <th>Tuesday<br>08/19<br><span class="day-info">B Day</span></th>
                    <th>Wednesday<br>08/20<br><span class="day-info">A Day - Early Out</span></th>
                    <th>Thursday<br>08/21<br><span class="day-info">B Day</span></th>
                    <th>Friday<br>08/22<br><span class="day-info">A Day</span></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="day-header">A1/B5<br>8:15-9:35</td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Monday', 'A1/B5', 'First Half', '8:15-8:55')">
                            FIRST HALF<br>(8:15-8:55)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Monday', 'A1/B5', 'Second Half', '8:55-9:35')">
                            SECOND HALF<br>(8:55-9:35)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Monday', 'A1/B5', 'Entire Period', '8:15-9:35')">
                            ENTIRE CLASS PERIOD<br>(8:15-9:35)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Tuesday', 'A1/B5', 'First Half', '8:15-8:55')">
                            FIRST HALF<br>(8:15-8:55)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Tuesday', 'A1/B5', 'Second Half', '8:55-9:35')">
                            SECOND HALF<br>(8:55-9:35)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Tuesday', 'A1/B5', 'Entire Period', '8:15-9:35')">
                            ENTIRE CLASS PERIOD<br>(8:15-9:35)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Wednesday', 'A1/B5', 'First Half', '8:15-8:50')">
                            FIRST HALF<br>(8:15-8:50)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Wednesday', 'A1/B5', 'Second Half', '8:50-9:25')">
                            SECOND HALF<br>(8:50-9:25)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Wednesday', 'A1/B5', 'Entire Period', '8:15-9:25')">
                            ENTIRE CLASS PERIOD<br>(8:15-9:25)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Thursday', 'A1/B5', 'First Half', '8:15-8:55')">
                            FIRST HALF<br>(8:15-8:55)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Thursday', 'A1/B5', 'Second Half', '8:55-9:35')">
                            SECOND HALF<br>(8:55-9:35)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Thursday', 'A1/B5', 'Entire Period', '8:15-9:35')">
                            ENTIRE CLASS PERIOD<br>(8:15-9:35)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Friday', 'A1/B5', 'First Half', '8:15-8:55')">
                            FIRST HALF<br>(8:15-8:55)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Friday', 'A1/B5', 'Second Half', '8:55-9:35')">
                            SECOND HALF<br>(8:55-9:35)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Friday', 'A1/B5', 'Entire Period', '8:15-9:35')">
                            ENTIRE CLASS PERIOD<br>(8:15-9:35)
                        </button>
                    </td>
                </tr>
                <tr>
                    <td class="day-header">Den Time<br>9:30-10:15</td>
                    <td>
                        <button class="booking-slot den-time" onclick="openBookingModal('Monday', 'Den Time', 'Den Time', '9:30-10:15')">
                            DEN TIME<br>(9:30-10:15)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot den-time" onclick="openBookingModal('Tuesday', 'Den Time', 'Den Time', '9:30-10:15')">
                            DEN TIME<br>(9:30-10:15)
                        </button>
                    </td>
                    <td>
                        <div class="den-time">Not Available</div>
                    </td>
                    <td>
                        <button class="booking-slot den-time" onclick="openBookingModal('Thursday', 'Den Time', 'Den Time', '9:30-10:15')">
                            DEN TIME<br>(9:30-10:15)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot den-time" onclick="openBookingModal('Friday', 'Den Time', 'Den Time', '9:30-10:15')">
                            DEN TIME<br>(9:30-10:15)
                        </button>
                    </td>
                </tr>

                <tr>
                    <td class="day-header">A2/B6<br>10:20-11:35</td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Monday', 'A2/B6', 'First Half', '10:20-10:57')">
                            FIRST HALF<br>(10:20-10:57)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Monday', 'A2/B6', 'Second Half', '10:57-11:35')">
                            SECOND HALF<br>(10:57-11:35)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Monday', 'A2/B6', 'Entire Period', '10:20-11:35')">
                            ENTIRE CLASS PERIOD<br>(10:20-11:35)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Tuesday', 'A2/B6', 'First Half', '10:20-10:57')">
                            FIRST HALF<br>(10:20-10:57)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Tuesday', 'A2/B6', 'Second Half', '10:57-11:35')">
                            SECOND HALF<br>(10:57-11:35)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Tuesday', 'A2/B6', 'Entire Period', '10:20-11:35')">
                            ENTIRE CLASS PERIOD<br>(10:20-11:35)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Wednesday', 'A2/B6', 'First Half', '9:30-10:05')">
                            FIRST HALF<br>(9:30-10:05)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Wednesday', 'A2/B6', 'Second Half', '10:05-10:40')">
                            SECOND HALF<br>(10:05-10:40)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Wednesday', 'A2/B6', 'Entire Period', '9:30-10:40')">
                            ENTIRE CLASS PERIOD<br>(9:30-10:40)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Thursday', 'A2/B6', 'First Half', '10:20-10:57')">
                            FIRST HALF<br>(10:20-10:57)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Thursday', 'A2/B6', 'Second Half', '10:57-11:35')">
                            SECOND HALF<br>(10:57-11:35)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Thursday', 'A2/B6', 'Entire Period', '10:20-11:35')">
                            ENTIRE CLASS PERIOD<br>(10:20-11:35)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Friday', 'A2/B6', 'First Half', '10:20-10:57')">
                            FIRST HALF<br>(10:20-10:57)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Friday', 'A2/B6', 'Second Half', '10:57-11:35')">
                            SECOND HALF<br>(10:57-11:35)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Friday', 'A2/B6', 'Entire Period', '10:20-11:35')">
                            ENTIRE CLASS PERIOD<br>(10:20-11:35)
                        </button>
                    </td>
                </tr>
                <tr>
                    <td class="day-header">A3/B7<br>12:10-1:25</td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Monday', 'A3/B7', 'First Half A3/B7', '11:40-12:30')">
                            FIRST HALF A3/B7<br>(11:40-12:30)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Monday', 'A3/B7', 'Second Half A3/B7', '12:30-1:25')">
                            SECOND HALF A3/B7<br>(12:30-1:25)
                        </button>
                        <div class="lunch-period">1ST LUNCH<br>(11:35-12:05)</div>
                        <div class="lunch-period">2ND LUNCH<br>(12:55-1:25)</div>
                        <button class="booking-slot entire" onclick="openBookingModal('Monday', 'A3/B7', 'Entire A3/B7 Period', '11:40-1:25')">
                            ENTIRE A3/B7 PERIOD<br>(11:40-1:25)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Tuesday', 'A3/B7', 'First Half A3/B7', '11:40-12:30')">
                            FIRST HALF A3/B7<br>(11:40-12:30)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Tuesday', 'A3/B7', 'Second Half A3/B7', '12:30-1:25')">
                            SECOND HALF A3/B7<br>(12:30-1:25)
                        </button>
                        <div class="lunch-period">1ST LUNCH<br>(11:35-12:05)</div>
                        <div class="lunch-period">2ND LUNCH<br>(12:55-1:25)</div>
                        <button class="booking-slot entire" onclick="openBookingModal('Tuesday', 'A3/B7', 'Entire A3/B7 Period', '11:40-1:25')">
                            ENTIRE A3/B7 PERIOD<br>(11:40-1:25)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Wednesday', 'A3/B7', 'First Half', '10:50-11:25')">
                            FIRST HALF<br>(10:50-11:25)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Wednesday', 'A3/B7', 'Second Half', '11:25-12:00')">
                            SECOND HALF<br>(11:25-12:00)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Wednesday', 'A3/B7', 'Entire Period', '10:50-12:00')">
                            ENTIRE CLASS PERIOD<br>(10:50-12:00)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Thursday', 'A3/B7', 'First Half A3/B7', '11:40-12:30')">
                            FIRST HALF A3/B7<br>(11:40-12:30)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Thursday', 'A3/B7', 'Second Half A3/B7', '12:30-1:25')">
                            SECOND HALF A3/B7<br>(12:30-1:25)
                        </button>
                        <div class="lunch-period">1ST LUNCH<br>(11:35-12:05)</div>
                        <div class="lunch-period">2ND LUNCH<br>(12:55-1:25)</div>
                        <button class="booking-slot entire" onclick="openBookingModal('Thursday', 'A3/B7', 'Entire A3/B7 Period', '11:40-1:25')">
                            ENTIRE A3/B7 PERIOD<br>(11:40-1:25)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Friday', 'A3/B7', 'First Half A3/B7', '11:40-12:30')">
                            FIRST HALF A3/B7<br>(11:40-12:30)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Friday', 'A3/B7', 'Second Half A3/B7', '12:30-1:25')">
                            SECOND HALF A3/B7<br>(12:30-1:25)
                        </button>
                        <div class="lunch-period">1ST LUNCH<br>(11:35-12:05)</div>
                        <div class="lunch-period">2ND LUNCH<br>(12:55-1:25)</div>
                        <button class="booking-slot entire" onclick="openBookingModal('Friday', 'A3/B7', 'Entire A3/B7 Period', '11:40-1:25')">
                            ENTIRE A3/B7 PERIOD<br>(11:40-1:25)
                        </button>
                    </td>
                </tr>
                <tr>
                    <td class="day-header">A4/B8<br>1:30-2:45</td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Monday', 'A4/B8', 'First Half', '1:30-2:07')">
                            FIRST HALF<br>(1:30-2:07)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Monday', 'A4/B8', 'Second Half', '2:07-2:45')">
                            SECOND HALF<br>(2:07-2:45)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Monday', 'A4/B8', 'Entire Period', '1:30-2:45')">
                            ENTIRE CLASS PERIOD<br>(1:30-2:45)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Tuesday', 'A4/B8', 'First Half', '1:30-2:07')">
                            FIRST HALF<br>(1:30-2:07)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Tuesday', 'A4/B8', 'Second Half', '2:07-2:45')">
                            SECOND HALF<br>(2:07-2:45)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Tuesday', 'A4/B8', 'Entire Period', '1:30-2:45')">
                            ENTIRE CLASS PERIOD<br>(1:30-2:45)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Wednesday', 'A4/B8', 'First Half', '12:05-12:40')">
                            FIRST HALF<br>(12:05-12:40)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Wednesday', 'A4/B8', 'Second Half', '12:40-1:15')">
                            SECOND HALF<br>(12:40-1:15)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Wednesday', 'A4/B8', 'Entire Period', '12:05-1:15')">
                            ENTIRE CLASS PERIOD<br>(12:05-1:15)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Thursday', 'A4/B8', 'First Half', '1:30-2:07')">
                            FIRST HALF<br>(1:30-2:07)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Thursday', 'A4/B8', 'Second Half', '2:07-2:45')">
                            SECOND HALF<br>(2:07-2:45)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Thursday', 'A4/B8', 'Entire Period', '1:30-2:45')">
                            ENTIRE CLASS PERIOD<br>(1:30-2:45)
                        </button>
                    </td>
                    <td>
                        <button class="booking-slot" onclick="openBookingModal('Friday', 'A4/B8', 'First Half', '1:30-2:07')">
                            FIRST HALF<br>(1:30-2:07)
                        </button>
                        <button class="booking-slot second-half" onclick="openBookingModal('Friday', 'A4/B8', 'Second Half', '2:07-2:45')">
                            SECOND HALF<br>(2:07-2:45)
                        </button>
                        <button class="booking-slot entire" onclick="openBookingModal('Friday', 'A4/B8', 'Entire Period', '1:30-2:45')">
                            ENTIRE CLASS PERIOD<br>(1:30-2:45)
                        </button>
                    </td>

                <tr>
                    <td class="day-header">After School<br>2:45-3:30</td>
                    <td>
                        <div class="after-school">AFTER SCHOOL<br>(2:45-3:30)</div>
                    </td>
                    <td>
                        <div class="after-school">AFTER SCHOOL<br>(2:45-3:30)</div>
                    </td>
                    <td>
                        <div class="lunch-period">LUNCH<br>(1:15-1:45)</div>
                    </td>
                    <td>
                        <div class="after-school">AFTER SCHOOL<br>(2:45-3:30)</div>
                    </td>
                    <td>
                        <div class="after-school">AFTER SCHOOL<br>(2:45-3:30)</div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Booking Modal -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBookingModal()">&times;</span>
            <h2>Book Library Time</h2>
            <div id="booking-details"></div>
            
            <form id="bookingForm">
                <div class="form-group">
                    <label for="teacherName">Teacher Name:</label>
                    <input type="text" id="teacherName" name="teacherName" required>
                </div>
                
                <div class="form-group">
                    <label for="classSubject">Class/Subject:</label>
                    <input type="text" id="classSubject" name="classSubject" required>
                </div>
                
                <div class="form-group">
                    <label for="notes">Notes (optional):</label>
                    <textarea id="notes" name="notes" placeholder="Enter any additional notes"></textarea>
                </div>
                
                <button type="button" class="btn" id="save-booking-btn" onclick="submitBooking()">Save Booking</button>
                <button type="button" class="btn btn-danger" id="delete-booking-btn" onclick="deleteBooking()" style="display: none;">Delete Booking</button>
                <button type="button" class="btn btn-secondary" onclick="closeBookingModal()">Cancel</button>
            </form>
        </div>
    </div>

    <script>
        console.log('JavaScript loaded!');
        
        let currentBooking = {};
        let bookings = {}; // Store all bookings
        let currentWeekStart = new Date(2025, 7, 11); // Starting with August 11, 2025 (Monday) - month is 0-indexed

        // Load bookings from localStorage on page load
        function loadBookingsFromStorage() {
            try {
                // Check if localStorage is available
                if (typeof(Storage) !== "undefined") {
                    const savedBookings = localStorage.getItem('libraryBookings');
                    console.log('localStorage available, savedBookings:', savedBookings);
                    
                    if (savedBookings) {
                        try {
                            bookings = JSON.parse(savedBookings);
                            console.log('Successfully loaded bookings from localStorage:', bookings);
                            console.log('Number of bookings loaded:', Object.keys(bookings).length);
                        } catch (error) {
                            console.error('Error parsing bookings from localStorage:', error);
                            bookings = {};
                        }
                    } else {
                        console.log('No saved bookings found in localStorage');
                        bookings = {};
                    }
                } else {
                    console.error('localStorage is not available in this browser');
                    bookings = {};
                }
            } catch (error) {
                console.error('Error accessing localStorage:', error);
                bookings = {};
            }
        }

        // Save bookings to localStorage
        function saveBookingsToStorage() {
            try {
                // Check if localStorage is available
                if (typeof(Storage) !== "undefined") {
                    const bookingsString = JSON.stringify(bookings);
                    localStorage.setItem('libraryBookings', bookingsString);
                    console.log('Successfully saved bookings to localStorage:', bookings);
                    console.log('Number of bookings saved:', Object.keys(bookings).length);
                    console.log('localStorage size:', bookingsString.length, 'characters');
                } else {
                    console.error('localStorage is not available in this browser');
                }
            } catch (error) {
                console.error('Error saving bookings to localStorage:', error);
                console.error('Error details:', error.message);
            }
        }

        // Test localStorage functionality
        function testLocalStorage() {
            const statusElement = document.getElementById('storage-status');
            
            try {
                if (typeof(Storage) !== "undefined") {
                    console.log('✅ localStorage is available');
                    
                    // Test writing and reading
                    const testKey = 'testKey';
                    const testValue = 'testValue';
                    localStorage.setItem(testKey, testValue);
                    const retrievedValue = localStorage.getItem(testKey);
                    
                    if (retrievedValue === testValue) {
                        console.log('✅ localStorage read/write test passed');
                        localStorage.removeItem(testKey); // Clean up
                        if (statusElement) {
                            statusElement.textContent = '✅ Storage working';
                            statusElement.style.color = '#28a745';
                        }
                    } else {
                        console.error('❌ localStorage read/write test failed');
                        if (statusElement) {
                            statusElement.textContent = '❌ Storage failed';
                            statusElement.style.color = '#dc3545';
                        }
                    }
                } else {
                    console.error('❌ localStorage is not available');
                    if (statusElement) {
                        statusElement.textContent = '❌ Storage unavailable';
                        statusElement.style.color = '#dc3545';
                    }
                }
            } catch (error) {
                console.error('❌ localStorage test failed:', error);
                if (statusElement) {
                    statusElement.textContent = '❌ Storage error';
                    statusElement.style.color = '#dc3545';
                }
            }
        }

        // Load bookings when page loads
        testLocalStorage();
        loadBookingsFromStorage();
        
        // Update calendar display after loading bookings
        // Use setTimeout to ensure DOM is fully loaded
        setTimeout(() => {
            updateCalendarDisplay();
            console.log('Calendar display updated with', Object.keys(bookings).length, 'bookings');
        }, 100);

        function openBookingModal(day, period, slotType, timeRange) {
            // Check if this slot is already booked
            const bookingKey = `${day}-${period}-${slotType}`;
            const existingBooking = bookings[bookingKey];
            
            if (existingBooking) {
                // Slot is already booked - show edit/cancel options
                const action = confirm(`This slot is booked by ${existingBooking.teacherName} for ${existingBooking.classSubject}.\n\nWould you like to:\n\nClick OK to edit/cancel this booking\nClick Cancel to keep the current booking`);
                
                if (action) {
                    // User wants to edit/cancel - show modal with existing data
                    currentBooking = {
                        day: day,
                        period: period,
                        slotType: slotType,
                        timeRange: timeRange
                    };
                    
                    document.getElementById('booking-details').innerHTML = 
                        `<p><strong>Edit Booking:</strong></p>
                         <p>Day: ${day}</p>
                         <p>Period: ${period}</p>
                         <p>Slot: ${slotType}</p>
                         <p>Time: ${timeRange}</p>`;
                    
                    // Pre-fill form with existing data
                    document.getElementById('teacherName').value = existingBooking.teacherName;
                    document.getElementById('classSubject').value = existingBooking.classSubject;
                    document.getElementById('notes').value = existingBooking.notes || '';
                    
                    // Show delete button and change save button text
                    document.getElementById('delete-booking-btn').style.display = 'inline-block';
                    document.getElementById('save-booking-btn').textContent = 'Update Booking';
                    
                    document.getElementById('bookingModal').style.display = 'block';
                    console.log('Opening edit modal for:', currentBooking);
                }
            } else {
                // New booking - check for conflicts
                const conflicts = checkForConflicts(day, period, slotType);
                
                if (conflicts.length > 0) {
                    let conflictMessage = 'This time slot conflicts with existing bookings:\n\n';
                    conflicts.forEach(conflict => {
                        conflictMessage += `• ${conflict.teacherName} - ${conflict.classSubject} (${conflict.slotType})\n`;
                    });
                    alert(conflictMessage);
                    return;
                }
                
                // Clear form for new booking
                currentBooking = {
                    day: day,
                    period: period,
                    slotType: slotType,
                    timeRange: timeRange
                };
                
                document.getElementById('booking-details').innerHTML = 
                    `<p><strong>New Booking:</strong></p>
                     <p>Day: ${day}</p>
                     <p>Period: ${period}</p>
                     <p>Slot: ${slotType}</p>
                     <p>Time: ${timeRange}</p>`;
                
                // Clear form fields
                document.getElementById('teacherName').value = '';
                document.getElementById('classSubject').value = '';
                document.getElementById('notes').value = '';
                
                // Hide delete button and reset save button text
                document.getElementById('delete-booking-btn').style.display = 'none';
                document.getElementById('save-booking-btn').textContent = 'Save Booking';
                
                document.getElementById('bookingModal').style.display = 'block';
                console.log('Opening new booking modal for:', currentBooking);
            }
        }

        function checkForConflicts(day, period, slotType) {
            const conflicts = [];
            console.log(`Checking conflicts for ${day}-${period}-${slotType}`);
            console.log('All bookings:', Object.keys(bookings));
            
            // Check all existing bookings for this day and period
            Object.keys(bookings).forEach(bookingKey => {
                const [bookingDay, bookingPeriod, bookingSlotType] = bookingKey.split('-');
                console.log(`Comparing with ${bookingKey}: day=${bookingDay}, period=${bookingPeriod}, slotType=${bookingSlotType}`);
                
                if (bookingDay === day && bookingPeriod === period) {
                    const booking = bookings[bookingKey];
                    console.log(`Found matching booking: ${bookingKey}`, booking);
                    
                    // Check for conflicts based on slot types
                    if (slotType === 'Entire Period') {
                        // If trying to book entire period, check if any part is already booked
                        if (bookingSlotType === 'First Half' || bookingSlotType === 'Second Half' || bookingSlotType === 'Entire Period') {
                            console.log(`Conflict found: ${slotType} conflicts with ${bookingSlotType}`);
                            conflicts.push(booking);
                        }
                    } else if (slotType === 'First Half' || slotType === 'Second Half') {
                        // If trying to book half, check if entire period is booked or if the same half is booked
                        if (bookingSlotType === 'Entire Period' || bookingSlotType === slotType) {
                            console.log(`Conflict found: ${slotType} conflicts with ${bookingSlotType}`);
                            conflicts.push(booking);
                        }
                    }
                }
            });
            
            console.log(`Total conflicts for ${day}-${period}-${slotType}:`, conflicts.length);
            return conflicts;
        }

        function closeBookingModal() {
            document.getElementById('bookingModal').style.display = 'none';
            document.getElementById('bookingForm').reset();
            currentBooking = {};
        }

        function submitBooking() {
            const teacherName = document.getElementById('teacherName').value;
            const classSubject = document.getElementById('classSubject').value;
            const notes = document.getElementById('notes').value;
            
            if (!teacherName || !classSubject) {
                alert('Please fill in Teacher Name and Class/Subject');
                return;
            }
            
            const bookingData = {
                ...currentBooking,
                teacherName: teacherName,
                classSubject: classSubject,
                notes: notes,
                timestamp: new Date().toISOString()
            };
            
            // Create a unique key for this booking
            const bookingKey = `${currentBooking.day}-${currentBooking.period}-${currentBooking.slotType}`;
            bookings[bookingKey] = bookingData;
            
            // Save to localStorage
            saveBookingsToStorage();
            
            console.log('Booking submitted:', bookingData);
            console.log('All bookings:', bookings);
            
            // Update the calendar display
            updateCalendarDisplay();
            
            const isUpdate = document.getElementById('save-booking-btn').textContent === 'Update Booking';
            const message = isUpdate ? 'Booking updated!' : 'Booking confirmed!';
            
            alert(`${message}\n\nTeacher: ${teacherName}\nClass: ${classSubject}\nTime: ${currentBooking.timeRange}\nDay: ${currentBooking.day}`);
            
            closeBookingModal();
        }

        function showRefreshButton() {
            // Create refresh button if it doesn't exist
            let refreshBtn = document.getElementById('refresh-page-btn');
            if (!refreshBtn) {
                refreshBtn = document.createElement('button');
                refreshBtn.id = 'refresh-page-btn';
                refreshBtn.textContent = '🔄 Refresh Page';
                refreshBtn.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background-color: #B3A369;
                    color: #000000;
                    border: none;
                    padding: 10px 15px;
                    border-radius: 5px;
                    cursor: pointer;
                    font-weight: bold;
                    z-index: 1000;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                `;
                refreshBtn.onclick = function() {
                    location.reload();
                };
                document.body.appendChild(refreshBtn);
            }
            
            // Show the button
            refreshBtn.style.display = 'block';
            
            // Auto-hide after 10 seconds
            setTimeout(() => {
                refreshBtn.style.display = 'none';
            }, 10000);
        }

        function deleteBooking() {
            console.log('deleteBooking called with:', currentBooking);
            if (!currentBooking || !currentBooking.day || !currentBooking.period || !currentBooking.slotType) {
                alert('No booking selected for deletion');
                return;
            }
            
            const bookingKey = `${currentBooking.day}-${currentBooking.period}-${currentBooking.slotType}`;
            const existingBooking = bookings[bookingKey];
            
            if (!existingBooking) {
                alert('No booking found to delete');
                return;
            }
            
            const confirmDelete = confirm(`Are you sure you want to delete this booking?\n\nTeacher: ${existingBooking.teacherName}\nClass: ${existingBooking.classSubject}\nTime: ${currentBooking.timeRange}\nDay: ${currentBooking.day}`);
            
            if (confirmDelete) {
                // First, close the modal to avoid any interference
                closeBookingModal();
                
                // Then delete the booking
                delete bookings[bookingKey];
                
                // Save to localStorage
                saveBookingsToStorage();
                
                console.log('Booking deleted:', bookingKey);
                console.log('All bookings:', bookings);
                
                // Update the calendar display
                updateCalendarDisplay();
                
                // Show refresh button
                showRefreshButton();
            }
        }

        // Close modal when clicking outside of it
        window.onclick = function(event) {
            const modal = document.getElementById('bookingModal');
            if (event.target === modal) {
                closeBookingModal();
            }
        }


        
        function updateCalendarDisplay() {
            console.log('Updating calendar display...');
            console.log('Current bookings:', bookings);
            
            // Update all booking buttons to show their status
            const buttons = document.querySelectorAll('.booking-slot');
            buttons.forEach(button => {
                const onclick = button.getAttribute('onclick');
                if (onclick) {
                    // Extract booking info from onclick attribute
                    const match = onclick.match(/openBookingModal\('([^']+)', '([^']+)', '([^']+)', '([^']+)'\)/);
                    if (match) {
                        const day = match[1];
                        const period = match[2];
                        const slotType = match[3];
                        const timeRange = match[4];
                        
                        const bookingKey = `${day}-${period}-${slotType}`;
                        const booking = bookings[bookingKey];
                        
                        console.log(`Checking ${bookingKey}:`, booking ? 'BOOKED' : 'AVAILABLE');
                        
                        if (booking) {
                            // Button is booked - show booking info
                            button.style.backgroundColor = '#6c757d';
                            button.style.border = '2px solid #495057';
                            button.innerHTML = `BOOKED<br>${booking.teacherName}<br>${booking.classSubject}`;
                            button.title = `Booked by ${booking.teacherName} - ${booking.classSubject}${booking.notes ? '\nNotes: ' + booking.notes : ''}`;
                        } else {
                            // Check if this slot is available or conflicting
                            const conflicts = checkForConflicts(day, period, slotType);
                            
                            console.log(`Conflicts for ${bookingKey}:`, conflicts.length);
                            
                            if (conflicts.length > 0) {
                                console.log(`CONFLICT DETECTED for ${bookingKey}:`, conflicts);
                                // Button is conflicting - show as unavailable
                                button.style.backgroundColor = '#dc3545';
                                button.style.border = '2px solid #721c24';
                                button.innerHTML = `UNAVAILABLE<br>(${timeRange})`;
                                button.title = 'This slot conflicts with existing bookings';
                                button.style.cursor = 'not-allowed';
                                // Remove onclick to prevent clicking
                                button.removeAttribute('onclick');
                            } else {
                                // Button is available - reset to original state
                                // Force remove all inline styles
                                button.removeAttribute('style');
                                button.title = '';
                                // Restore original onclick
                                button.setAttribute('onclick', `openBookingModal('${day}', '${period}', '${slotType}', '${timeRange}')`);
                                
                                // Restore original text and styling based on slot type
                                console.log(`Processing slot type: "${slotType}"`);
                                
                                if (slotType === 'First Half') {
                                    button.innerHTML = `FIRST HALF<br>(${timeRange})`;
                                    button.className = 'booking-slot';
                                } else if (slotType === 'Second Half') {
                                    button.innerHTML = `SECOND HALF<br>(${timeRange})`;
                                    button.className = 'booking-slot second-half';
                                } else if (slotType === 'Entire Period') {
                                    console.log('Processing Entire Period slot');
                                    button.innerHTML = `ENTIRE CLASS PERIOD<br>(${timeRange})`;
                                    button.className = 'booking-slot entire';
                                    // Force the black background with !important
                                    button.style.setProperty('background-color', '#000000', 'important');
                                    button.style.setProperty('color', '#FFFFFF', 'important');
                                    
                                    // Force a repaint
                                    button.offsetHeight;
                                    
                                    // Debug: Check what the button actually looks like
                                    console.log('Button after restoration:', {
                                        className: button.className,
                                        backgroundColor: button.style.backgroundColor,
                                        color: button.style.color,
                                        computedStyle: window.getComputedStyle(button).backgroundColor
                                    });
                                } else if (slotType === 'Entire A3/B7 Period') {
                                    console.log('Processing Entire A3/B7 Period slot');
                                    button.innerHTML = `ENTIRE CLASS PERIOD<br>(${timeRange})`;
                                    button.className = 'booking-slot entire';
                                    // Force the black background with !important
                                    button.style.setProperty('background-color', '#000000', 'important');
                                    button.style.setProperty('color', '#FFFFFF', 'important');
                                    
                                    // Force a repaint
                                    button.offsetHeight;
                                    
                                    // Debug: Check what the button actually looks like
                                    console.log('Button after restoration:', {
                                        className: button.className,
                                        backgroundColor: button.style.backgroundColor,
                                        color: button.style.color,
                                        computedStyle: window.getComputedStyle(button).backgroundColor
                                    });
                                } else if (slotType === 'Den Time') {
                                    button.innerHTML = `DEN TIME<br>(${timeRange})`;
                                    button.className = 'booking-slot den-time';
                                } else {
                                    console.log(`Unknown slot type: "${slotType}"`);
                                }
                                
                                console.log(`Restored ${slotType} button to available state`);
                            }
                        }
                    }
                }
            });
        }



        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeBookingModal();
            }
        });

        // Week navigation functions
        function updateWeekDisplay() {
            const weekEnd = new Date(currentWeekStart);
            weekEnd.setDate(weekEnd.getDate() + 4); // Friday
            
            const options = { month: 'long', day: 'numeric', year: 'numeric' };
            const startDate = currentWeekStart.toLocaleDateString('en-US', options);
            const endDate = weekEnd.toLocaleDateString('en-US', options);
            
            document.getElementById('current-week').textContent = `Week of ${startDate} - ${endDate}`;
        }

        function getNotesForDate(date) {
            // This would typically come from your Google Sheets data
            // For now, I'll add some example notes for specific dates
            const notesData = {
                '2025-08-11': 'No School<br>Summer Break',
                '2025-08-12': 'No School<br>Summer Break',
                '2025-08-13': 'No School<br>7th Grade Day',
                '2025-08-14': 'First Day of School',
                '2025-08-15': 'Picture Day',
                '2025-08-20': 'Early Out',
                '2025-08-27': 'Early Out',
                '2025-09-01': 'Labor Day - No School',
                '2025-09-26': 'Library Closed<br>Librarians at Conference',
                '2025-09-29': 'No School<br>Teacher Work Day',
                '2025-09-30': 'Library Closed<br>Librarians at Conference',
                '2025-10-16': 'No School<br>Fall Break',
                '2025-10-17': 'No School<br>Fall Break',
                '2025-10-20': 'No School<br>PD Day',
                '2025-10-30': 'Peterson Out',
                '2025-11-26': 'No School<br>Thanksgiving Break',
                '2025-11-27': 'No School<br>Thanksgiving Break',
                '2025-11-28': 'No School<br>Thanksgiving Break',
                '2025-12-19': 'Minimal Day',
                '2025-12-22': 'No School<br>Winter Break',
                '2025-12-23': 'No School<br>Winter Break',
                '2025-12-24': 'No School<br>Winter Break',
                '2025-12-25': 'No School<br>Winter Break',
                '2025-12-26': 'No School<br>Winter Break',
                '2025-12-29': 'No School<br>Winter Break',
                '2025-12-30': 'No School<br>Winter Break',
                '2025-12-31': 'No School<br>Winter Break',
                '2026-01-01': 'No School<br>Winter Break',
                '2026-01-02': 'No School<br>Winter Break',
                '2026-01-05': 'No School<br>Teacher Work Day - No School',
                '2026-01-19': 'No School<br>MLK Day',
                '2026-01-29': 'Peterson Out',
                '2026-02-06': 'No School<br>Teacher Work Day',
                '2026-02-16': 'No School<br>President\'s Day',
                '2026-03-09': 'No School<br>PD Day',
                '2026-03-23': 'No School<br>Teacher Work Day',
                '2026-04-06': 'No School<br>Spring Break',
                '2026-04-07': 'No School<br>Spring Break',
                '2026-04-08': 'No School<br>Spring Break',
                '2026-04-09': 'No School<br>Spring Break',
                '2026-04-10': 'No School<br>Spring Break',
                '2026-04-30': 'Peterson Out',
                '2026-05-04': 'Star Wars Week',
                '2026-05-05': 'Star Wars Week',
                '2026-05-06': 'Star Wars Week',
                '2026-05-07': 'Star Wars Week',
                '2026-05-08': 'Star Wars Week - All Books Due',
                '2026-05-11': 'Library Inventory',
                '2026-05-12': 'Library Inventory',
                '2026-05-13': 'Library Inventory',
                '2026-05-14': 'Library Inventory',
                '2026-05-15': 'Library Inventory',
                '2026-05-18': 'Library Inventory',
                '2026-05-19': 'Library Inventory',
                '2026-05-20': 'Library Inventory',
                '2026-05-21': 'Library Inventory',
                '2026-05-22': 'Last Day of School'
            };
            
            const dateString = date.toISOString().split('T')[0];
            return notesData[dateString] || '';
        }

        function isDayClosed(date) {
            // Check if the day should be closed (no school, library closed, etc.)
            const notes = getNotesForDate(date);
            const closedKeywords = ['No School', 'Library Closed', 'Holiday', 'Break'];
            
            return closedKeywords.some(keyword => notes.includes(keyword));
        }

        function updateBookingSlotsForClosedDays() {
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
            
            // Check each day of the week
            for (let i = 0; i < 5; i++) {
                const currentDate = new Date(currentWeekStart);
                currentDate.setDate(currentWeekStart.getDate() + i);
                
                if (isDayClosed(currentDate)) {
                    // Get all booking slots for this day (column i+1)
                    const dayColumn = document.querySelectorAll(`tbody tr td:nth-child(${i + 2})`);
                    
                    dayColumn.forEach(cell => {
                        // Block booking slots
                        const bookingSlots = cell.querySelectorAll('.booking-slot');
                        bookingSlots.forEach(slot => {
                            slot.classList.add('closed');
                            slot.removeAttribute('onclick');
                            slot.title = 'Library Closed - No Bookings Available';
                        });
                        
                        // Block lunch periods
                        const lunchPeriods = cell.querySelectorAll('.lunch-period');
                        lunchPeriods.forEach(lunch => {
                            lunch.classList.add('closed');
                            lunch.style.opacity = '0.6';
                            lunch.style.cursor = 'not-allowed';
                            lunch.title = 'Library Closed - No Bookings Available';
                        });
                        
                        // Block den time
                        const denTime = cell.querySelectorAll('.den-time');
                        denTime.forEach(den => {
                            den.classList.add('closed');
                            den.style.opacity = '0.6';
                            den.style.cursor = 'not-allowed';
                            den.title = 'Library Closed - No Bookings Available';
                        });
                        
                        // Block after school
                        const afterSchool = cell.querySelectorAll('.after-school');
                        afterSchool.forEach(after => {
                            after.classList.add('closed');
                            after.style.opacity = '0.6';
                            after.style.cursor = 'not-allowed';
                            after.title = 'Library Closed - No Bookings Available';
                        });
                    });
                } else {
                    // Re-enable booking slots for open days
                    const dayColumn = document.querySelectorAll(`tbody tr td:nth-child(${i + 2})`);
                    
                    dayColumn.forEach(cell => {
                        // Re-enable booking slots
                        const bookingSlots = cell.querySelectorAll('.booking-slot');
                        bookingSlots.forEach(slot => {
                            slot.classList.remove('closed');
                            slot.title = '';
                        });
                        
                        // Re-enable lunch periods
                        const lunchPeriods = cell.querySelectorAll('.lunch-period');
                        lunchPeriods.forEach(lunch => {
                            lunch.classList.remove('closed');
                            lunch.style.opacity = '1';
                            lunch.style.cursor = 'default';
                            lunch.title = '';
                        });
                        
                        // Re-enable den time
                        const denTime = cell.querySelectorAll('.den-time');
                        denTime.forEach(den => {
                            den.classList.remove('closed');
                            den.style.opacity = '1';
                            den.style.cursor = 'default';
                            den.title = '';
                        });
                        
                        // Re-enable after school
                        const afterSchool = cell.querySelectorAll('.after-school');
                        afterSchool.forEach(after => {
                            after.classList.remove('closed');
                            after.style.opacity = '1';
                            after.style.cursor = 'default';
                            after.title = '';
                        });
                    });
                }
            }
        }

        function getDayTypeForDate(date) {
            // This would typically come from your Google Sheets data
            // For now, I'll add the correct day types for specific dates
            const dayTypeData = {
                '2025-08-11': 'No School', // Monday
                '2025-08-12': 'B Day', // Tuesday
                '2025-08-13': 'No School', // Wednesday
                '2025-08-14': 'A Day', // Thursday - First Day of School
                '2025-08-15': 'B Day', // Friday
                '2025-08-18': 'A Day', // Monday
                '2025-08-19': 'B Day', // Tuesday
                '2025-08-20': 'A Day - Early Out', // Wednesday
                '2025-08-21': 'B Day', // Thursday
                '2025-08-22': 'A Day', // Friday
                '2025-08-25': 'A Day', // Monday
                '2025-08-26': 'B Day', // Tuesday
                '2025-08-27': 'A Day - Early Out', // Wednesday
                '2025-08-28': 'B Day', // Thursday
                '2025-08-29': 'A Day', // Friday
                '2025-09-01': 'No School', // Monday - Labor Day
                '2025-09-02': 'B Day', // Tuesday
                '2025-09-03': 'A Day - Early Out', // Wednesday
                '2025-09-04': 'B Day', // Thursday
                '2025-09-05': 'A Day', // Friday
                '2025-09-26': 'B Day', // Friday
                '2025-09-29': 'No School', // Monday
                '2025-09-30': 'A Day', // Tuesday
                '2025-10-16': 'No School', // Thursday
                '2025-10-17': 'No School', // Friday
                '2025-10-20': 'No School', // Monday
                '2025-10-30': 'B Day', // Thursday
                '2025-11-26': 'No School', // Wednesday
                '2025-11-27': 'No School', // Thursday
                '2025-11-28': 'No School', // Friday
                '2025-12-19': 'A Day', // Friday
                '2025-12-22': 'No School', // Monday
                '2025-12-23': 'No School', // Tuesday
                '2025-12-24': 'No School', // Wednesday
                '2025-12-25': 'No School', // Thursday
                '2025-12-26': 'No School', // Friday
                '2025-12-29': 'No School', // Monday
                '2025-12-30': 'No School', // Tuesday
                '2025-12-31': 'No School', // Wednesday
                '2026-01-01': 'No School', // Thursday
                '2026-01-02': 'No School', // Friday
                '2026-01-05': 'No School', // Monday
                '2026-01-19': 'No School', // Monday
                '2026-01-29': 'A Day', // Thursday
                '2026-02-06': 'No School', // Friday
                '2026-02-16': 'No School', // Monday
                '2026-03-09': 'No School', // Monday
                '2026-03-23': 'No School', // Monday
                '2026-04-06': 'No School', // Monday
                '2026-04-07': 'No School', // Tuesday
                '2026-04-08': 'No School', // Wednesday
                '2026-04-09': 'No School', // Thursday
                '2026-04-10': 'No School', // Friday
                '2026-04-30': 'B Day', // Thursday
                '2026-05-04': 'B Day', // Monday
                '2026-05-05': 'A Day', // Tuesday
                '2026-05-06': 'B Day', // Wednesday
                '2026-05-07': 'A Day', // Thursday
                '2026-05-08': 'B Day', // Friday
                '2026-05-11': 'A Day', // Monday
                '2026-05-12': 'B Day', // Tuesday
                '2026-05-13': 'A Day', // Wednesday
                '2026-05-14': 'B Day', // Thursday
                '2026-05-15': 'A Day', // Friday
                '2026-05-18': 'B Day', // Monday
                '2026-05-19': 'A Day', // Tuesday
                '2026-05-20': 'B Day', // Wednesday
                '2026-05-21': 'A Day', // Thursday
                '2026-05-22': 'B Day', // Friday
            };
            
            const dateString = date.toISOString().split('T')[0];
            return dayTypeData[dateString] || 'A Day'; // Default to A Day if not specified
        }



        function updateCalendarHeaders() {
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
            const dayHeaders = document.querySelectorAll('thead th');
            
            // Skip the first header (Time column)
            for (let i = 1; i <= 5; i++) {
                const currentDate = new Date(currentWeekStart);
                currentDate.setDate(currentWeekStart.getDate() + (i - 1));
                
                const month = (currentDate.getMonth() + 1).toString().padStart(2, '0');
                const day = currentDate.getDate().toString().padStart(2, '0');
                
                const dayType = getDayTypeForDate(currentDate);
                let headerContent = `${days[i-1]}<br>${month}/${day}<br><span class="day-info">${dayType}</span>`;
                
                // Add notes if they exist for this date
                const notes = getNotesForDate(currentDate);
                if (notes) {
                    headerContent += `<br><span class="day-notes">${notes}</span>`;
                }
                
                dayHeaders[i].innerHTML = headerContent;
            }
            
            // Update booking slots for closed days
            updateBookingSlotsForClosedDays();
        }

        function previousWeek() {
            currentWeekStart.setDate(currentWeekStart.getDate() - 7);
            updateWeekDisplay();
            updateCalendarHeaders();
            console.log('Previous week clicked');
        }

        function nextWeek() {
            currentWeekStart.setDate(currentWeekStart.getDate() + 7);
            updateWeekDisplay();
            updateCalendarHeaders();
            console.log('Next week clicked');
        }

        // Initialize week display and calendar headers
        updateWeekDisplay();
        updateCalendarHeaders();
    </script>
</body>
</html> 
